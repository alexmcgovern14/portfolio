import { Link } from 'react-router-dom';
import { ArrowLeft, Github, ChevronLeft, ChevronRight } from 'lucide-react';
import type { Project } from '../../types/project';
import substackLogo from '../../../assets/substack-logo.png';

interface ProjectDetailHeaderProps {
  project: Project;
  slug: string;
  isScrolled: boolean;
  nextProject?: { slug: string; title: string } | null;
  prevProject?: { slug: string; title: string } | null;
}

export function ProjectDetailHeader({ project, slug, isScrolled, nextProject, prevProject }: ProjectDetailHeaderProps) {
  const getSubheading = () => {
    switch (slug) {
      case 'rag-ai-system':
        return 'LLM semantic search through vectorised data';
      case 'live-match-summary':
        return 'Case study in building AI features: data-led live updates for football matches';
      case 'lineup-changes':
        return 'Case study in building with LLMs, model limitations and building effective systems.';
      case 'portfolio-website':
        return 'Design, development and deployment of portfolio website in AI-native workflow';
      case 'spotify-recommendation-engine':
        return 'Solving my own need for better recommendations on Spotify';
            case 'escape-the-rain':
        return 'Combines real-time weather forecasts with spatial search to identify nearest dry locations';
default:
        return null;
    }
  };

  const category = (slug === 'live-match-summary' || slug === 'lineup-changes') 
    ? 'LiveScore feature' 
    : 'Personal project';

  return (
    <header 
      className={`sticky top-0 z-50 w-full bg-[#2a2628]/95 backdrop-blur-sm transition-all duration-500 ease-in-out ${isScrolled ? 'shadow-lg' : ''}`} 
      style={{ borderBottom: '1px solid rgba(108, 105, 106, 0.3)' }}
    >
      <div className="max-w-[1920px] mx-auto px-12">
        {/* Top Navigation */}
        <div className="py-4 flex items-center justify-between">
          <Link
            to="/"
            className="inline-flex items-center gap-2 text-white hover:text-[#7ACAFF] transition-colors"
          >
            <ArrowLeft className="w-4 h-4" />
            <span className="font-medium">Back</span>
          </Link>
          
          {/* Project Navigation Arrows */}
          <div className="flex items-center gap-2">
            {prevProject ? (
              <Link
                to={`/featured/${prevProject.slug}`}
                className="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-white hover:bg-white/10 transition-colors"
                title={`Previous: ${prevProject.title}`}
              >
                <ChevronLeft className="w-5 h-5" />
                <span className="hidden sm:inline text-sm font-medium"><strong>Previous:</strong> {prevProject.title}</span>
              </Link>
            ) : null}
            
            {nextProject ? (
              <Link
                to={`/featured/${nextProject.slug}`}
                className="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-white hover:bg-white/10 transition-colors"
                title={`Next: ${nextProject.title}`}
              >
                <span className="hidden sm:inline text-sm font-medium"><strong>Next:</strong> {nextProject.title}</span>
                <ChevronRight className="w-5 h-5" />
              </Link>
            ) : null}
          </div>
        </div>

        {/* Title and Metadata - Collapses on scroll */}
        <div 
          className="overflow-hidden"
          style={{
            transition: 'transform 400ms cubic-bezier(0.4, 0, 0.2, 1), opacity 400ms cubic-bezier(0.4, 0, 0.2, 1)',
            transformOrigin: 'top',
            transform: isScrolled ? 'scaleY(0)' : 'scaleY(1)',
            opacity: isScrolled ? 0 : 1,
            height: isScrolled ? 0 : 'auto',
            willChange: 'transform, opacity',
          }}
        >
          <div 
            className="pb-6"
            style={{
              transform: isScrolled ? 'translateY(-20px)' : 'translateY(0)',
              transition: 'transform 400ms cubic-bezier(0.4, 0, 0.2, 1)',
            }}
        >
          <h1 className="font-['Instrument_Serif:Regular',sans-serif] text-5xl text-[rgb(255,255,255)] mb-4 leading-tight">
            {project.titleParts ? (
              project.titleParts.map((part, index) => (
                <span 
                  key={index}
                  className={part.gradient ? "bg-clip-text bg-gradient-to-r from-[#7ACAFF] to-[#67FFC2]" : "text-white"}
                  style={part.gradient ? { WebkitTextFillColor: "transparent" } : {}}
                >
                  {part.text}
                </span>
              ))
            ) : (
              <span className="text-white">{project.title}</span>
            )}
          </h1>
          
          {getSubheading() && (
            <p className="text-[#D6D6D6] text-base lg:text-xl mb-6 leading-relaxed">
              {getSubheading()}
            </p>
          )}
          
          {/* Category pill and GitHub button */}
          <div className="flex items-center gap-4 flex-wrap md:flex-nowrap">
            <div 
              className="backdrop-blur-[2px] rounded-[100px] inline-block shadow-[0px_4px_4px_0px_rgba(0,0,0,0.25)]"
              style={{
                backgroundColor: 'rgba(255,255,255,0.15)',
                border: '1px solid rgba(255,255,255,0.6)'
              }}
            >
              <div className="flex flex-row items-center justify-center">
                <div className="content-stretch flex items-center justify-center px-[12px] py-[8px] relative">
                  <p className="font-['DM_Mono:Regular',sans-serif] leading-[normal] not-italic relative shrink-0 text-[14px] text-nowrap text-white">
                    {category}
                  </p>
                </div>
              </div>
              <div className="absolute inset-[-0.25px] pointer-events-none shadow-[inset_0px_-4px_4px_0px_rgba(0,0,0,0.25),inset_0px_4px_4px_0px_rgba(255,255,255,0.1)] rounded-[100px]" />
            </div>
            
            {project && 'githubUrl' in project && project.githubUrl && (
              <a
                href={project.githubUrl}
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-2 bg-gradient-to-r from-[#7ACAFF] to-[#67FFC2] text-black hover:opacity-90 transition-opacity px-4 py-2 rounded-lg font-medium text-sm"
              >
                <Github className="w-4 h-4" />
                <span>GitHub</span>
              </a>
            )}
            {project && 'substackUrl' in project && project.substackUrl && (
              <a
                href={project.substackUrl}
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-2 bg-gradient-to-r from-[#7ACAFF] to-[#67FFC2] text-black hover:opacity-90 transition-opacity px-4 py-2 rounded-lg font-medium text-sm"
              >
                <img src={substackLogo} alt="Substack" className="w-5 h-5" style={{ filter: 'brightness(0)' }} />
                <span>Substack</span>
              </a>
            )}
          </div>
        </div>
      </div>
    </header>
  );
}




